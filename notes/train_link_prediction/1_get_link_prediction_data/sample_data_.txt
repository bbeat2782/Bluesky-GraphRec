src_node	dst_node	timestamp	edge_id	src_idx
57074	640960	1686165347	13700579	13700579
39961	146565	1686165347	13700580	13700580
3817	608421	1686165347	13700581	13700581
53351	355145	1686165347	13700582	13700582
92199	734414	1686165347	13700583	13700583

head=5

sample_source_indices:
[13700579 13700580 13700581 13700582 13700583 13700584 13700585 13700586
 13700587 13700588]

 batch_neg_dst_node_ids.shape: (512, 4)
batch_neg_dst_node_ids: [[2587891 1859664  888291 4930601]
 [1222690 3453630 3636111 4292462]
 [ 802711 3485272 4773639 1829070]
 [5041652 3489965 3957104 3653878]
 [1436802 5279290 1295235 1475371]]

 

batch_neg_src_node_ids and  batch_neg_src_idx
repeats each source node 4 times, where we keep the same source node but pair it with different destination nodes.

 batch_src_node_ids=[1,2], it becomes [[1,1,1,1], [2,2,2,2]]